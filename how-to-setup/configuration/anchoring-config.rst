
.. _anchoring-settings:

Настройка анкоринга
=======================

Если используете опцию :ref:`анкоринга <anchoring>`, необходимо настроить блок ``anchoring``.

    ::

      anchoring {
      enable = yes
      height-range = 5
      height-above = 6
      threshold = 1

      mainnet-authorization {
      type = "oauth2"
      authorization-token = "PawC6b86r2pNRTR5e88wvcL3gfkG87w2Lqkvk4Jph2PUG3zPLedCTjnjh2ZTw3Rf"
      authorization-service-url = "https://washington.testnet.com/authServiceAddress/v1/auth/token"
      token-update-interval = "60s"
      }

      mainnet-scheme-byte = "K"
      mainnet-node-address = "http://node.washington"
      mainnet-node-port = 6862
      mainnet-node-recipient-address = "3JWveBpXS1EcDpxcoAwVNAjFfUMrxaALgZt"
      mainnet-private-key-password = ""

       wallet {
       file = "node-1_mainnet-wallet.dat"
       password = "small"
        }

      mainnet-fee = 500000
      sidechain-fee = 500000
     }
      
**Параметры анкоринга**

* ``height-range`` - число блоков, через которое нода приватного блокчейна отправляет в Mainnet транзакции для анкоринга.
* ``height-above`` - число блоков в Mainnet, через которое нода приватного блокчейна создаёт подтверждающую анкоринг транзакцию с данными первой транзакции. Рекомендуется устанавливать значение, близкое к максимальной величине отката в Mainnet ``max-rollback``.
* ``threshold`` - число блоков, которое отнимается от текущей высоты приватного блокчейна. В транзакцию для анкоринга, отправляемую в Mainnet, попадёт информация из блока на высоте ``current-height - threshold``. Если устанавливается значение 0, то берётся информация из текущего блока. Рекомендуется устанавливать значение, близкое к максимальной величине отката в приватном блокчейне ``max-rollback``.

**Параметры авторизации при использовании анкоринга**

* ``type`` - тип авторизации при использовании анкоринга. ``api-key`` - авторизация по ``api-key-hash``, ``auth-service`` - авторизация по специальному токену.

В случае выбора авторизации по ``api-key-hash`` достаточно указать значение ключа в параметре ``api-key`` ниже. Если вы выбираете авторизацию по токену, необходимо указать ``type = "auth-service"``, раскомментировать параметры ниже и установить для них значения:

* ``authorization-token`` - постоянный авторизационный токен.
* ``authorization-service-url`` - URL-адрес сервиса авторизации.
* ``token-update-interval`` - интервал обновления авторизационного токена.

**Параметры для доступа Mainnet**

Для ноды, которая будет отправлять транзакции анкоринга в Mainnet, генерируется отдельный файл ``keystore.dat`` с ключевой парой для доступа в Mainnet.

* ``mainnet-scheme-byte`` - байт сети Mainnet.
* ``mainnet-node-address`` - сетевой адрес ноды в сети Mainnet, на который будут отправляться транзакции для анкоринга.
* ``mainnet-node-port`` - номер порта ноды в сети Mainnet, на который будут отправляться транзакции для анкоринга.
* ``mainnet-node-recipient-address`` - адрес ноды в сети Mainnet, на который будут записываться транзакции для анкоринга, подписанные ключевой парой данного адреса.

Сетевой адрес и порт для анкоринга в сеть Mainnet/Partnernet можно получить у сотрудников технической поддержки Waves Enterprise. Если используется несколько приватных блокчейнов с взаимным анкорингом, то необходимо использовать соответствующие сетевые настройки частных сетей.

**Параметры файла с ключевой парой для подписания транзакций анкоринга в Mainnet, секция wallet**

* ``file`` - имя файла и путь до каталога хранения файла с ключевой парой для подписания транзакций анкоринга в сети Mainnet. Файл находится на ноде приватной сети.
* ``password`` - пароль от файла с ключевой парой.

**Параметры комиссий**

* ``mainnet-fee`` - плата за выпуск транзакции для анкоринга в сети Mainnet.
* ``sidechain-fee`` - плата за выпуск транзакции в приватном блокчейне.






